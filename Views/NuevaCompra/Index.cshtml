@model List<PROYECTO_WEB.Controllers.Producto_VC>
@{
    ViewBag.Title = "Index";
    string id_pr = Session["id_pro"].ToString();
    string nombre_pr = Session["nombre_pr"].ToString();
}

<h2 style="color:white">COMPRAS</h2>

<div class="d-flex">
    <div class="col-sm-5 p-1 parte01">
        <div class="card bg-dark" style="border-color:transparent">
            <div class="card-body" style="color:white">
                <!-- --------------------------------------------------------- DATOS DEL PROVEEDOR ------------------------------------------------------------ -->
                @using (Html.BeginForm("BuscarProveedor", "NuevaCompra", FormMethod.Post))
                {
                    <div class="form-group">
                        <label>Datos del proveedor</label>
                    </div>
                    <div class="form-group d-flex justify-content-between">
                        <div class="col-sm-6 d-flex">
                            @Html.TextBox("nombre_pr", nombre_pr, new { @class = "form-control", @placeholder = "Nombre proveedor", @autocomplete = "off" })
                            <button style="border-color: transparent; --bs-btn-hover-bg: #1F618D; --bs-btn-color: #1F618D;" onclick="" type="submit" name="btn_enviar" value="Buscar Cliente" class="btn btn-outline-light"><i class="fa-solid fa-magnifying-glass"></i></button>
                        </div>
                        <div class="col-sm-5 ms-auto">
                            @Html.TextBox("id", id_pr, new { @type = "number", @class = "form-control", @placeholder = "nit", @readonly = "readonly" })
                        </div>
                    </div>
                }
                <br>
                <!-- ----------------------------------------- DATOS DEL PRODUCTO -------------------------------------------------- -->
                @using (Html.BeginForm("BuscarProducto", "NuevaCompra", FormMethod.Post))
                {
                    <div class="form-group">
                        <label>Datos producto</label>
                    </div>
                    <div class="form-group d-flex justify-content-between">
                        <div class="col-sm-6 d-flex">
                            @Html.TextBox("id_p", Session["id_p_prov"].ToString(), new { @type = "number", @class = "form-control", @placeholder = "Cod producto", @autocomplete = "off" })
                            <button style="border-color: transparent; --bs-btn-hover-bg: #1F618D;; --bs-btn-color: #1F618D;" type="submit" name="btn_enviar" value="Buscar Producto" class="btn btn-outline-light"><i class="fa-solid fa-magnifying-glass"></i></button>
                        </div>
                        <div class="col-sm-5 ms-auto">
                            @Html.TextBox("nombre_p", Session["nombre_p_prov"].ToString(), new { @class = "form-control", @placeholder = "Datos producto", @readonly = "readonly" })
                        </div>
                    </div>
                    <br>
                    <div class="form-group d-flex justify-content-between">
                        <div class="col-sm-4">
                            @Html.TextBox("precio_p", Session["precio_p_prov"].ToString(), new { @class = "form-control", @placeholder = "$0.00", @readonly = "readonly" })
                        </div>
                        <div class="col-sm-2">
                            @Html.TextBox("cantidad_p", Session["cantidad_p_prov"].ToString(), new { @class = "form-control", @onkeypress = "return false;", @type = "number", @min = "1" })
                        </div>
                        <div class="col-sm-5">
                            @Html.TextBox("stock_p", Session["stock_p_prov"].ToString(), new { @class = "form-control", @placeholder = "Stock", @readonly = "readonly" })
                        </div>
                    </div>
                    <br>
                    <div class="form-group">
                        <button style="border-color: #1F618D; --bs-btn-hover-bg: #1F618D; --bs-btn-color: #1F618D;" type="submit" name="btn_enviar" value="Agregar" class="btn btn-outline-info">Agregar producto</button>
                    </div>
                }
            </div>
        </div>
    </div>
    <div class="col-sm-7 p-1 parte02">
        <div class="card bg-dark" style="border-color:transparent; color:white">
            <div class="card-body">
                <div class="d-flex col-sm-6 ms-auto">
                    <label class="col-sm-4">Número serie: </label>
                    @Html.TextBox("numero_serie", Session["numero_serie_co"].ToString(), new { @class = "form-control", @readonly = "readonly" })
                </div>
                <br>
                <table class="table table-dark table-sm align-middle">
                    @if (Model == null)
                    {
                        <thead>
                            <tr class="text-center">
                                <th>Número</th>
                                <th>Codigo</th>
                                <th>Descripcion</th>
                                <th>Precio</th>
                                <th>Cantidad</th>
                                <th>SubTotal</th>
                                <th class="accion">Acciones</th>
                            </tr>
                        </thead>
                    }
                    else
                    {
                        <thead>
                            <tr class="text-center">
                                <th>Número</th>
                                <th>Codigo</th>
                                <th>Descripcion</th>
                                <th>Precio</th>
                                <th>Cantidad</th>
                                <th>SubTotal</th>
                                <th class="accion">Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            @for (int i = 0; i < Model.Count; i++)
                            {
                                <tr class="text-center align-middle">
                                    <td>@(i+1)</td>
                                    <td>@Model[i].codigo</td>
                                    <td>@Model[i].descripcion</td>
                                    <td>@Model[i].precio</td>
                                    <td>@Model[i].cantidad</td>
                                    <td>@Model[i].subtotal</td>
                                    <td>
                                        @using (Html.BeginForm("BorrarProducto", "NuevaCompra", FormMethod.Post))
                                        {
                                            <button name="btn_borrar" type="submit" style="border-color: transparent;" class="btn btn-outline-danger" value="@i"><i class="fa-solid fa-trash-can"></i></button>
                                        }
                                    </td>
                                </tr>
                            }
                        </tbody>
                    }
                </table>
            </div>
            <div class="card-footer d-flex">
                <div class="col-sm-6">
                    @Html.ActionLink("Generar venta", "GenerarCompra", "NuevaCompra", new { area = "" }, new { @class = "btn btn-outline-info", @style = "border-color: #306A2C; --bs-btn-hover-bg: #306A2C; --bs-btn-color: #306A2C;", @onclick = "print()" })
                    @Html.ActionLink("Cancelar", "CancelarCompra", "NuevaCompra", new { area = "" }, new { @class = "btn btn-outline-info", @style = "border-color: #AF2929; --bs-btn-hover-bg: #AF2929; --bs-btn-color: #AF2929;" })
                </div>
                <div class="col-sm-5 ms-auto d-flex">
                    <label class="col-sm-6"><b>Total a pagar:</b></label>
                    @Html.TextBox("total_venta", Session["total_v_prov"].ToString(), new { @class = "form-control", @readonly = "readonly" })
                </div>
            </div>
        </div>
    </div>
</div>


